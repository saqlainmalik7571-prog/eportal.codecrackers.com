<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Student Registration | Code Crackers</title>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <style>
      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        font-family: "Poppins", sans-serif;
        background: radial-gradient(ellipse at bottom, #020b0f 0%, #000 100%);
        color: #00ffcc;
      }

      .stars,
      .twinkling {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
      }

      .stars {
        background: transparent
          url("https://www.transparenttextures.com/patterns/stardust.png")
          repeat;
        animation: moveStars 200s linear infinite;
        opacity: 0.4;
      }

      .twinkling {
        background: transparent
          url("https://www.transparenttextures.com/patterns/tiny-crosses.png")
          repeat;
        animation: twinkle 3s ease-in-out infinite alternate;
        opacity: 0.2;
      }

      @keyframes moveStars {
        from {
          background-position: 0 0;
        }
        to {
          background-position: -10000px 5000px;
        }
      }
      @keyframes twinkle {
        0% {
          opacity: 0.1;
        }
        100% {
          opacity: 0.4;
        }
      }

      .container {
        position: relative;
        z-index: 2;
        width: 90%;
        max-width: 420px;
        background: rgba(0, 20, 20, 0.4);
        border: 1px solid #00ffaa;
        border-radius: 20px;
        box-shadow: 0 0 25px #00ffcc55, 0 0 60px rgba(0, 255, 200, 0.4);
        overflow: hidden;
        backdrop-filter: blur(10px);
        animation: fadeIn 1s ease forwards;
        text-align: center;
        padding: 25px;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      h2 {
        margin-bottom: 10px;
        color: #00ffcc;
        text-shadow: 0 0 10px #00ffcc;
      }

      p {
        color: #8affd1;
        font-size: 14px;
        margin-bottom: 15px;
      }

      input {
        width: 100%;
        margin: 8px 0;
        padding: 12px;
        border: 1px solid #00ffaa;
        border-radius: 20px;
        outline: none;
        background: rgba(0, 0, 0, 0.5);
        color: #00ffcc;
        text-align: center;
        font-size: 14px;
        transition: 0.3s;
        box-shadow: 0 0 5px #00ffaa;
      }

      input::placeholder {
        color: #66ffe0;
      }

      input:focus {
        box-shadow: 0 0 15px #00ffcc, 0 0 30px #00ffaa;
        transform: scale(1.03);
      }

      button {
        width: 100%;
        padding: 12px;
        margin-top: 10px;
        border: 1px solid #00ffaa;
        border-radius: 25px;
        background: transparent;
        color: #00ffcc;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
        text-shadow: 0 0 5px #00ffcc;
        box-shadow: 0 0 10px #00ffaa inset, 0 0 15px #00ffaa;
      }

      button:hover {
        background: #00ffaa22;
        transform: scale(1.05);
        box-shadow: 0 0 25px #00ffaa, 0 0 40px #00ffcc;
      }

      .roll-display {
        margin-top: 15px;
        color: #00ffcc;
        font-weight: bold;
        font-size: 16px;
        text-shadow: 0 0 10px #00ffcc;
        display: none;
      }

      @media (max-width: 480px) {
        .container {
          padding: 20px;
        }
      }
    </style>
  </head>

  <body>
    <div class="stars"></div>
    <div class="twinkling"></div>

    <div class="container">
      <h2>Student Registration</h2>
      <p>Register to get your roll number and notify the admin via email.</p>

      <input type="text" id="name" placeholder="Full Name" required />
      <input type="email" id="email" placeholder="Email Address" required />
      <input type="text" id="education" placeholder="Education Level" required />
      <input type="password" id="password" placeholder="Create Password" required />

      <button onclick="registerStudent()">Register</button>

      <div class="roll-display" id="rollDisplay"></div>
    </div>

    <script>
      (function () {
        emailjs.init("YOUR_PUBLIC_KEY_HERE"); // üîπ Replace with your EmailJS Public Key
      })();

      function registerStudent() {
        const name = document.getElementById("name").value.trim();
        const email = document.getElementById("email").value.trim();
        const education = document.getElementById("education").value.trim();
        const password = document.getElementById("password").value.trim();
        const rollDisplay = document.getElementById("rollDisplay");

        if (!name || !email || !education || !password) {
          alert("‚ö†Ô∏è Please fill out all fields before registering.");
          return;
        }

        // Get and update roll number
        let lastRoll = localStorage.getItem("lastRollNumber");
        if (!lastRoll) lastRoll = 0;
        const newRoll = parseInt(lastRoll) + 1;
        localStorage.setItem("lastRollNumber", newRoll);
        const formattedRoll = "CC" + String(newRoll).padStart(3, "0");

        // Save locally
        let students = JSON.parse(localStorage.getItem("students")) || [];
        students.push({ name, email, education, roll: formattedRoll });
        localStorage.setItem("students", JSON.stringify(students));

        // Display roll number
        rollDisplay.style.display = "block";
        rollDisplay.innerHTML = `üéâ Registration Successful!<br>Your Roll Number: <span style="color:#00ffaa">${formattedRoll}</span>`;

        // ‚úâÔ∏è Send email to admin via EmailJS
        emailjs
          .send("YOUR_SERVICE_ID", "YOUR_TEMPLATE_ID", {
            name: name,
            email: email,
            education: education,
            roll: formattedRoll,
          })
          .then(
            () => {
              console.log("‚úÖ Email sent successfully!");
            },
            (error) => {
              console.error("‚ùå Email failed:", error);
            }
          );

        // Clear fields
        document.getElementById("name").value = "";
        document.getElementById("email").value = "";
        document.getElementById("education").value = "";
        document.getElementById("password").value = "";
      }
    </script>
  </body>
</html>
